<!DOCTYPE html>
<!-- saved from url=(0032)http://127.0.0.1:8000/category/8 -->
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    {% load static %}
    <title>首页</title>
    <link rel="stylesheet" href="../static/首页_files/login.css">
    <link rel="stylesheet" href="../static/首页_files/index.css">
    <link rel="stylesheet" href="../static/首页_files/detail.css">
    <link rel="stylesheet" href="../static/首页_files/carts.css">
    <link rel="stylesheet" href="../static/首页_files/reset.css">
    <link rel="stylesheet" href="../static/首页_files/mygxin.css">
    <script src="../static/首页_files/jquery.min.js.下载"></script>
    <script src="../static/首页_files/carts.js.下载"></script>
    <style>
        #pager {
            text-align: center;
            font-size: 16px;
            overflow: hidden;
            margin-top: 20px; /* 调整上边距以适应页面布局 */
        }

        #pager a {
            display: inline-block;
            padding: 8px 12px; /* 调整填充以增大点击区域，便于使用 */
            margin: 5px;
            background-color: #f0f0f0; /* 背景颜色 */
            color: #333; /* 文本颜色 */
            border-radius: 5px; /* 圆角边框 */
            text-decoration: none; /* 去掉下划线 */
            transition: background-color 0.3s ease; /* 过渡效果 */
        }

        #pager a:hover {
            background-color: #4CAF50; /* 鼠标悬停时的背景颜色 */
            color: #fff; /* 鼠标悬停时的文字颜色 */
        }

        #pager span {
            display: inline-block;
            padding: 8px 12px;
            margin: 5px;
            background-color: #4CAF50; /* 当前页码的背景颜色 */
            color: #fff; /* 当前页码的文字颜色 */
            border-radius: 5px; /* 圆角边框 */
        }

        #pager form {
            display: inline-block; /* 使表单与链接在同一行显示 */
        }

        #pager input[type="number"] {
            display: inline-block;
            padding: 5px;
            width: 80px; /* 输入框宽度 */
            border-radius: 5px; /* 圆角边框 */
            text-align: center; /* 文字居中 */
            margin-right: 5px; /* 右边距 */
            border: 1px solid #ccc; /* 边框 */
        }

        #pager input[type="submit"] {
            padding: 5px 15px;
            background-color: #4CAF50; /* 提交按钮背景颜色 */
            color: #fff; /* 提交按钮文字颜色 */
            border: none; /* 去掉边框 */
            border-radius: 5px; /* 圆角边框 */
            cursor: pointer; /* 鼠标形状 */
        }

        #pager input[type="submit"]:hover {
            background-color: #45a049; /* 鼠标悬停时的背景颜色 */
        }

        .classes-items {
            position: relative;
        }

        .slider {
            height: 7px; /* 滑块的厚度，可以根据需要调整 */
            width: 0; /* 初始宽度设为0，会在JavaScript中动态设置 */
            background-color: #e31d1d; /* 滑块的背景色，可以根据需要调整 */
            position: absolute;
            bottom: 0; /* 保证滑块位于选项底部 */
            left: 0;
            transition: all 0.3s ease; /* 平滑过渡效果，可以根据需要调整 */
        }
    </style>
</head>
<body>

<div class="head">
    <div class="head-in">
        <ul class="options">
            <li class="sub"><a href="/user/login">我的订单</a></li>

            <li class="sub"><a href="/user/login">我的购物车</a></li>
        </ul>

        <div class="sign"><a href="/user/login">登录或注册</a></div>


    </div>
</div>
<div class="search">
    <ul class="items">
        <li class="item">
            <a href="http://127.0.0.1:8000/?category=2#">
                <img src="../static/首页_files/1_09.png">
                <p>10:00开抢</p>
            </a>
        </li>
        <li class="item">
            <a href="http://127.0.0.1:8000/?category=2#">
                <img src="../static/首页_files/1_11.png">
                <p>买手砍价</p>
            </a>
        </li>
        <li class="item">
            <a href="http://127.0.0.1:8000/?category=2#">
                <img src="../static/首页_files/1_13.png">
                <p>验货质检</p>
            </a>
        </li>
    </ul>
    <form action="{% url 'search_products' %}" method="get" id="search-form" class="input">
        <input type="text" name="q" value="请输入想找的宝贝" style="color: #aaa;"
               onfocus="if (this.value == '请输入想找的宝贝') {this.value = ''; this.style.color = '#000';}"
               onblur="if (this.value == '') {this.value = '请输入想找的宝贝'; this.style.color = '#aaa';}">
        <img src="{% static '首页_files/1_06.png' %}" onclick="document.getElementById('search-form').submit();"
             style="cursor: pointer;">
    </form>
</div>


<div class="classes">
    <ul class="classes-items">
        <li class="items"><a href="http://127.0.0.1:8000/get_products/?category_id=0">全部商品</a></li>
        <li class="items"><a href="http://127.0.0.1:8000/get_products/?category_id=1">个人电脑和配件</a></li>
        <li class="items"><a href="http://127.0.0.1:8000/get_products/?category_id=2">移动设备</a></li>
        <li class="items"><a href="http://127.0.0.1:8000/get_products/?category_id=3">家用电子产品</a></li>
        <li class="items"><a href="http://127.0.0.1:8000/get_products/?category_id=4">厨房电子设备</a></li>
        <li class="items"><a href="http://127.0.0.1:8000/get_products/?category_id=5">办公设备</a></li>
        <li class="items"><a href="http://127.0.0.1:8000/get_products/?category_id=6">汽车电子设备</a></li>
        <li class="items"><a href="http://127.0.0.1:8000/get_products/?category_id=7">网络和通信设备</a></li>
        <li class="items"><a href="http://127.0.0.1:8000/get_products/?category_id=8">可穿戴设备</a></li>
        <li class="items"><a href="http://127.0.0.1:8000/get_products/?category_id=9">智能家居设备</a></li>
        <div id="slider" class="slider"></div>
    </ul>
</div>

<div class="goods-model">
    <div class="goods-content">
        {% for product in products %} <!-- 遍历所有商品对象 -->
            <div class="good">
                <a href="{% url 'product_details' product.shop_product_id %}"> <!-- 生成商品详情页面的链接 -->
                    <img src="{% static '商品图片/'|add:product.product_image_url %}"
                         onerror="this.onerror=null;this.src='{% static '商品图片/1.jpg' %}';" width="285px"
                         height="285px">
                    {% for product2 in products2 %}
                        {% if product.product_id == product2.p_id %}
                            <p class="name">{{ product2.p_name }}</p>
                        {% endif %}
                    {% endfor %}
                    <div class="price">
                        <p>￥{{ product.current_price }}</p>
                        {#                    <s>￥499.00</s>#}
                    </div>
                </a>
            </div>
        {% endfor %}
    </div>
</div>

<div id="pager" style="text-align: center; font-size: 16px; overflow: hidden; margin-top: 10px;">
    <!-- 如果不是第一页，添加跳转到第一页的链接 -->
    {% if products.number != 1 %}
        <a href="?category_id={{ category_id }}&page=1"
           style="display: inline-block; padding: 5px; margin: 5px;">&laquo;第一页</a>
    {% endif %}

    {% if products.has_previous %}
        <a href="?category_id={{ category_id }}&page={{ products.previous_page_number }}"
           style="display: inline-block; padding: 5px; margin: 5px;">上一页</a>
    {% endif %}

    <span>第 {{ products.number }} 页, 共 {{ products.paginator.num_pages }} 页</span>

    {% if products.has_next %}
        <a href="?category_id={{ category_id }}&page={{ products.next_page_number }}"
           style="display: inline-block; padding: 5px; margin: 5px;">下一页</a>
    {% endif %}

    <!-- 如果不是最后一页，添加跳转到最后一页的链接 -->
    {% if products.number != products.paginator.num_pages %}
        <a href="?category_id={{ category_id }}&page={{ products.paginator.num_pages }}"
           style="display: inline-block; padding: 5px; margin: 5px;">最后一页&raquo;</a>
    {% endif %}
    <!-- 添加页面跳转功能 -->
    <form action="" method="get" style="display: inline-block;">
        <input type="hidden" name="category_id" value="{{ category_id }}">
        <input type="number" name="page" min="1" max="{{ products.paginator.num_pages }}" required
               placeholder="页码" style="margin-left: 5px; margin-right: 5px; text-align: center;">
        <input type="submit" value="跳转" style="padding: 5px; margin: 5px;">
    </form>
</div>


<script>
    {#$('#pager').css({'text-align': 'center', 'font-size': '16px', 'overflow': 'hidden', 'margin-top': '10px'})#}
    {#$('#pager a').css({'display': 'inline-block', 'padding': '5px', 'margin': '5px'})#}
    document.addEventListener('DOMContentLoaded', function () {
        var goods = document.querySelectorAll('.good');
        var delay = 0.1;

        goods.forEach(function (good) {
            good.style.animationDelay = delay + 's';
            delay += 0.1;
        });
    });
    document.addEventListener('DOMContentLoaded', function () {
        var slider = document.getElementById('slider');
        var categoryLinks = document.querySelectorAll('.classes-items .items > a');

        // 用于存储当前激活类别的变量
        var currentActiveCategory = null;

        // 尝试匹配当前URL的类别，并移动滑块到对应位置，否则默认为第一个类别
        var activeLinkSelector = '.classes-items .items > a[href="' + window.location.href + '"]';
        var matchingLink = document.querySelector(activeLinkSelector) || document.querySelector('.classes-items .items > a');

        // 首次移动滑块到匹配的或默认位置
        setSlider(matchingLink);

        // 为每个类别链接添加点击事件监听器
        categoryLinks.forEach(function (link) {
            link.addEventListener('click', function () {
                // 更新滑块位置
                setSlider(link);
                // 记录当前激活的类别
                currentActiveCategory = link;
            });
        });

        function setSlider(targetLink) {
            // 检查是否有之前点击的类别，如果有，从那里开始动画，否则直接设置
            if (currentActiveCategory) {
                animateSlider(targetLink);
            } else {
                updateSliderWithoutAnimation(targetLink);
            }
        }

        function animateSlider(targetLink) {
            // 计算目标位置和宽度
            var targetPosition = targetLink.offsetLeft;
            var targetWidth = targetLink.offsetWidth;

            // 设置动画的起始位置为当前滑块位置
            var startPosition = parseFloat(slider.style.left);
            var distance = targetPosition - startPosition;
            var animationDuration = 300; // 动画持续时间，单位毫秒
            var startTime;

            function animate(time) {
                if (startTime === undefined) {
                    startTime = time;
                }
                var elapsed = time - startTime;
                // 计算动画进度
                var progress = Math.min(elapsed / animationDuration, 1);

                // 更新滑块位置
                slider.style.left = (startPosition + distance * progress) + 'px';
                slider.style.width = targetWidth + 'px';

                if (progress < 1) {
                    // 如果动画未完成，继续动画
                    requestAnimationFrame(animate);
                }
            }

            requestAnimationFrame(animate);
        }

        function updateSliderWithoutAnimation(targetLink) {
            // 直接更新到目标位置，无动画
            slider.style.left = targetLink.offsetLeft + 'px';
            slider.style.width = targetLink.offsetWidth + 'px';
        }
    });
</script>


</body>
</html>