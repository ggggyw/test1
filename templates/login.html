<!DOCTYPE html>
<html lang="en">
<head>
       {% load static %}
    <meta charset="UTF-8">
    <title>Login</title>
    <style>
        :root {
	/* COLORS */
	--white: #e9e9e9;
	--gray: #333;
	--blue: #0367a6;
	--lightblue: #008997;

	/* RADII */
	--button-radius: 0.7rem;

	/* SIZES */
	--max-width: 758px;
	--max-height: 420px;

	font-size: 16px;
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
		Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
}

body {
	align-items: center;
	background-color: var(--white);
{#background: url("https://res.cloudinary.com/dci1eujqw/image/upload/v1616769558/Codepen/waldemar-brandt-aThdSdgx0YM-unsplash_cnq4sb.jpg");#}
	background: url('{% static "/登录_files/R.gif" %}');
    background-attachment: fixed;
	background-position: center;
	background-repeat: no-repeat;
	background-size: cover;
	display: grid;
	height: 100vh;
	place-items: center;
}

.form__title {
	font-weight: 300;
	margin: 0;
	margin-bottom: 1.25rem;
}

.link {
	color: var(--gray);
	font-size: 0.9rem;
	margin: 0.7rem 0;
	text-decoration: none;
}

.container {
	background-color: var(--white);
	border-radius: var(--button-radius);
	box-shadow: 0 0.9rem 1.7rem rgba(0, 0, 0, 0.25),
		0 0.7rem 0.7rem rgba(0, 0, 0, 0.22);
	height: var(--max-height);
	max-width: var(--max-width);
	overflow: hidden;
	position: relative;
	width: 100%;
}

.container__form {
	height: 100%;
	position: absolute;
	top: 0;
	transition: all 0.6s ease-in-out;
}

.container--signin {
	left: 0;
	width: 50%;
	z-index: 2;
}

.container.right-panel-active .container--signin {
	transform: translateX(100%);
}

.container--signup {
	left: 0;
	opacity: 0;
	width: 50%;
	z-index: 1;
}

.container.right-panel-active .container--signup {
	animation: show 0.6s;
	opacity: 1;
	transform: translateX(100%);
	z-index: 5;
}

.container__overlay {
	height: 100%;
	left: 50%;
	overflow: hidden;
	position: absolute;
	top: 0;
	transition: transform 0.6s ease-in-out;
	width: 50%;
	z-index: 100;
}

.container.right-panel-active .container__overlay {
	transform: translateX(-100%);
}

.overlay {
	background-color: var(--lightblue);
	background: url('{% static "/登录_files/R.gif" %}');
    background-attachment: fixed;
	background-position: center;
	background-repeat: no-repeat;
	background-size: cover;
	height: 100%;
	left: -100%;
	position: relative;
	transform: translateX(0);
	transition: transform 0.6s ease-in-out;
	width: 200%;
}

.container.right-panel-active .overlay {
	transform: translateX(50%);
}

.overlay__panel {
	align-items: center;
	display: flex;
	flex-direction: column;
	height: 100%;
	justify-content: center;
	position: absolute;
	text-align: center;
	top: 0;
	transform: translateX(0);
	transition: transform 0.6s ease-in-out;
	width: 50%;
}

.overlay--left {
	transform: translateX(-20%);
}

.container.right-panel-active .overlay--left {
	transform: translateX(0);
}

.overlay--right {
	right: 0;
	transform: translateX(0);
}

.container.right-panel-active .overlay--right {
	transform: translateX(20%);
}

.btn {
	background-color: var(--blue);
	background-image: linear-gradient(90deg, var(--blue) 0%, var(--lightblue) 74%);
	border-radius: 20px;
	border: 1px solid var(--blue);
	color: var(--white);
	cursor: pointer;
	font-size: 0.8rem;
	font-weight: bold;
	letter-spacing: 0.1rem;
	padding: 0.9rem 4rem;
	text-transform: uppercase;
	transition: transform 80ms ease-in;
}

.form > .btn {
	margin-top: 1.5rem;
}

.btn:active {
	transform: scale(0.95);
}

.btn:focus {
	outline: none;
}

.form {
	background-color: var(--white);
	display: flex;
	align-items: center;
	justify-content: center;
	flex-direction: column;
	padding: 0 3rem;
	height: 100%;
	text-align: center;
}

.input {
	background-color: #fff;
	border: none;
	padding: 0.9rem 0.9rem;
	margin: 0.5rem 0;
	width: 100%;
}

@keyframes show {
	0%,
	49.99% {
		opacity: 0;
		z-index: 1;
	}

	50%,
	100% {
		opacity: 1;
		z-index: 5;
	}
}

    {#-----------------------选择------------------------------------#}
.radio-input input {
  display: none;
}

.radio-input {
  --container_width: 180px;
  position: relative;
  display: flex;
  align-items: center;
  border-radius: 9999px;
  background-color: #fff;
  color: #000000;
  width: var(--container_width);
  overflow: hidden;
  border: 1px solid rgba(53, 52, 52, 0.226);
}

.radio-input label {
  width: 100%;
  padding: 10px;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1;
  font-weight: 600;
  letter-spacing: -1px;
  font-size: 14px;
}

.selection {
  display: none;
  position: absolute;
  height: 100%;
  width: calc(var(--container_width) / 3);
  z-index: 0;
  left: 0;
  top: 0;
  transition: .15s ease;
}

.radio-input label:has(input:checked) {
  color: #fff;
}

.radio-input label:has(input:checked) ~ .selection {
  background-color: rgb(11 117 223);
  display: inline-block;
}

.radio-input label:nth-child(1):has(input:checked) ~ .selection {
  transform: translateX(calc(var(--container_width) * 0/3));
}

.radio-input label:nth-child(2):has(input:checked) ~ .selection {
  transform: translateX(calc(var(--container_width) * 1/3));
}

.radio-input label:nth-child(3):has(input:checked) ~ .selection {
  transform: translateX(calc(var(--container_width) * 2/3));
}

    {#-------------------------------------------------------------#}
.message-container {
    animation: slideDownFadeOut 3s forwards;
}

@keyframes slideDownFadeOut {
    0% {
        transform: translateY(-100%);
        opacity: 0;
    }
    20% {
        transform: translateY(0);
        opacity: 1;
    }
    80% {
        opacity: 1;
    }
    100% {
        opacity: 0;
        transform: translateY(-100%);
    }
}
    </style>
</head>
<body>
<div class="container right-panel-active">
	<div class="container__form container--signup">
		<form action="/user/register/" class="form" id="form1" method="post">
            {% csrf_token %}
            <h2 class="form__title">注册</h2>
			<input type="text" placeholder="用户" class="input" name="nname"/>
{#			<input type="email" placeholder="电子邮件" class="input" />#}
			<input type="password" placeholder="密码" class="input" name="ppassword"/>
            <p> </p>
            <div class="radio-input" name="role">
              <label>
                <input value="user" name="role" id="value-1" type="radio" checked="">
                <span>用户</span>
              </label>
              <label>
                <input value="shop" name="role" id="value-2" type="radio">
                <span>商家</span>
              </label>
              <label>
                <input value="admin" name="role" id="value-3" type="radio">
                <span>管理员</span>
              </label>
              <span class="selection"></span>
            </div>
            <input type="submit" class="btn" value="注册">

		</form>
	</div>

	<div class="container__form container--signin">
		<form action="{% url 'login' %}" class="form" id="form2" method="post">
            {% csrf_token %}
			<h2 class="form__title">登录</h2>
            <input type="text" placeholder="用户" class="input" name="name"/>
			<input type="password" placeholder="密码" class="input" name="password" />
            <p></p>

            <div class="radio-input" name="role">
              <label>
                <input value="user" name="role" id="value-1" type="radio" checked="">
                <span>用户</span>
              </label>
              <label>
                <input value="shop" name="role" id="value-2" type="radio">
                <span>商家</span>
              </label>
              <label>
                <input value="admin" name="role" id="value-3" type="radio">
                <span>管理员</span>
              </label>
              <span class="selection"></span>
            </div>

			<a href="#" class="link">忘记密码？</a>
			<input type="submit" class="btn" value="登录">
		</form>
	</div>

	<div class="container__overlay">
		<div class="overlay">
			<div class="overlay__panel overlay--left">
				<button class="btn" id="signIn">登录</button>
			</div>
			<div class="overlay__panel overlay--right">
				<button class="btn" id="signUp">注册</button>
			</div>
		</div>
	</div>
</div>

{% if messages %}
<script>
// 创建一个空数组来存储消息
var djangoMessages = [];

{% for message in messages %}
    // 将每个消息添加到数组中
    djangoMessages.push({"level": "{{ message.tags }}", "text": "{{ message|escapejs }}"});
{% endfor %}
</script>
{% endif %}

</body>

<script>


// 当页面加载完成后执行
window.onload = function() {
    // 检查 djangoMessages 是否存在并且包含消息
    if(typeof djangoMessages !== 'undefined' && djangoMessages.length > 0) {
        // 通过遍历所有的 djangoMessages 来显示消息
        djangoMessages.forEach(function(message){
            // 使用模态框或自定义弹窗展示消息
            displayMessage(message.level, message.text);
        });
    }
};

function displayMessage(level, text) {
    // 创建消息容器
    var messageContainer = document.createElement('div');
    messageContainer.classList.add('message-container', level);
    messageContainer.textContent = text;

    // 添加样式
    messageContainer.style.position = 'fixed';
    messageContainer.style.top = '0';
    messageContainer.style.left = '0';
    messageContainer.style.width = '100%';
    messageContainer.style.padding = '1rem';
    messageContainer.style.backgroundColor = level === 'error' ? 'red' : 'green';
    messageContainer.style.color = 'white';
    messageContainer.style.textAlign = 'center';

    // 将消息容器添加到页面中
    document.body.prepend(messageContainer);

    // 一段时间后移除消息
    setTimeout(function() {
        messageContainer.remove();
    }, 3000);  // 在3秒后消息消失
}
const signInBtn = document.getElementById("signIn");
const signUpBtn = document.getElementById("signUp");
const firstForm = document.getElementById("form1");
const secondForm = document.getElementById("form2");
const container = document.querySelector(".container");

// 默认显示登录表单
container.classList.remove("right-panel-active");

signInBtn.addEventListener("click", () => {
    container.classList.remove("right-panel-active");
});

signUpBtn.addEventListener("click", () => {
    container.classList.add("right-panel-active");
});

firstForm.addEventListener("submit", () => {
    // 这里不需要阻止默认提交行为
});

secondForm.addEventListener("submit", () => {
    // 这里不需要阻止默认提交行为
});


</script>
</html>