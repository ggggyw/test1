<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    {% load static %}
    <title>shop_order</title>
    <link rel="stylesheet" href="{% static '商家_files/head.css' %}">
    <link rel="stylesheet" href="{% static '商家_files/shop_order.css' %}">


    <style>
        /* --------------------------------------页面整体字体和背景 ------------------------------*/
        body {
            margin: 0;
            padding: 0;
            font-family: "Arial", sans-serif;
            background-attachment: fixed;
            background-size: cover;
            color: #333;
        }

        /* ------------------------------------------头部样式--------------------------------- */
        .shop_head {
            background-color: #8accf8; /* 深色背景 */
            color: #fff;
            padding: 10px 0;
            width: 100%; /* 设置宽度为100% */
        }

        .shop_head-in {
            max-width: 1320px;
            margin: 0 auto;
            display: flex;
            width: 100%; /* 设置宽度为100% */
            justify-content: space-between;
            align-items: center;
        }

        .shop_register a {
            color: #fff;
            margin-right: 1px;
            text-decoration: none;
            transition: color 0.3s;
        }

        .shop_register a:hover {
            color: #030303;
            font-size: 15px;
        }

        /* --------------------------------------------搜索框样式----------------------------------- */
        .shop_search {
            padding: 15px 0;
            background-color: #fff;
            border-bottom: 1px solid #eaeaea;
        }

        .shop_search .input {
            display: flex; /* 使用flex布局 */
            align-items: center; /* 垂直居中对齐 */
            justify-content: start; /* 从左边开始排列 */
            max-width: 1320px;
            margin: 0 auto;
            position: relative;
        }

        .shop_search input[type="text"] {
            flex-grow: 1; /* 让输入框填满剩余空间 */
            padding: 10px 15px;
            font-size: 16px;
            border: 1px solid #ddd;
            border-radius: 2px;
            margin-left: 10px; /* 在图标和输入框之间添加间距 */
            color: #000; /* 默认颜色，可根据实际需要调整 */
        }

        .shop_search img {
            width: 50px;
            height: auto;
            transition: transform 0.3s ease; /* 添加平滑过渡效果 */
        }

        .shop_search img:hover {
            cursor: pointer;
            transform: scale(1.2); /* 放大10% */
        }

        /* -------------------------------------------------------------类别导航样式--------------------------------------------- */
        .shop_classes {
            z-index: 0;
            padding: 10px 0;
            background: #ffffff;
            margin: 10px auto; /* 增加外部间距 */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 2000px; /* 设置一个最大宽度 */
            display: flex; /* 使用flex布局 */
            justify-content: center; /* 水平居中 */
            flex-wrap: wrap; /* 允许子元素换行 */
            border-radius: 0; /* 修改这里 */
        }

        /* 将每个类别列表设置为块级元素，这样它们将各占一行 */
        .shop_classes-items {
            display: flex;
            flex-direction: row;
            justify-content: center;
            padding: 0;
            margin: 0 1px; /* 添加左右间距用于分隔两个列表 */
            text-align: center; /* 文字居中 */
            list-style: none; /* 去除列表默认样式 */
            position: relative;
        }


        .shop_classes-items a {

            text-align: center;
            display: block;
            font: bold 16px Arial, sans-seri;
            white-space: nowrap;
            clear: both;
            padding: 0 1px;
            margin: 0 5px;
            transition: background-color 0.3s, color 0.3s;
            border-radius: 0; /* 修改这里 */
        }

        .shop_classes-items a:hover {
            background-color: #524747;
            color: #ee4848;
        }

        /* 选中的类别样式 */
        .shop_classes-items a.selected {
            background-color: #89cdda; /* 被选中项的背景色 */
            color: #fff; /* 被选中项的文本色 */
            border: 2px solid #ffffff; /* 边框，可以根据需要调整颜色和大小 */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3); /* 阴影效果 */
            /* 可加入其他样式，如边框、阴影等 */
        }

        .shop_classes-items a.selected1 {
            background-color: #89cdda; /* 被选中项的背景色 */
            color: #fff; /* 被选中项的文本色 */
            border: 2px solid #ffffff; /* 边框，可以根据需要调整颜色和大小 */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3); /* 阴影效果 */
            transition: all 0.8s ease;
            /* 可加入其他样式，如边框、阴影等 */
        }

        /* 底部滑块的样式 */
        .shop_classes-slider {
            height: 6px;
            width: 2px;
            background-color: #89cdda; /* 滑块颜色 */
            position: absolute;
            bottom: 0;
            transition: all 0.2s ease; /* 平滑的过渡效果 */
        }

        /* 类别项样式 */
        .shop_items {
            display: flex;
            flex-direction: row;
            margin: 5px; /* 给每个项目添加外边距增加间隔感 */
        }

        .shop_items a {
            display: block;
            padding: 10px 15px;
            text-decoration: none;
            color: #333;
            border-right: 1px solid #e5e5e5; /* 在列表项之间添加边框 */
            transition: background-color 0.3s;
        }


        .shop_items a:hover {
            background-color: #c2c2c2; /* 将背景设置为深灰色 */
            color: #fff; /* 通常鼠标悬停时文本颜色需要设为亮色，以保证对比 */
        }

        .order-detail-toggle {
            cursor: pointer;
            background-color: #f9f9f9;
            padding: 5px;
            text-align: center;
            border: 1px solid #d3d3d3;
        }

        .order-details {
            display: none;
            margin-top: 10px;
        }

        /* 将表格居中且宽度最大化，每列有一定的间距 */
        table {
            margin: 0 auto;
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 15px; /* 控制列之间的间距 */
        }

        /* 调整表格标题和内部文本的样式 */
        th, td {
            text-align: center;
            padding: 10px 20px; /* 增加内填充以便有更多空间 */
        }

        /* 为表格标题设置一个背景颜色，字体颜色和字体大小 */
        thead th {
            background-color: #4CAF50; /* 示例背景颜色，可根据喜好修改 */
            color: white; /* 示例字体颜色，可根据喜好修改 */
            font-size: 1.1em;
        }

        /* 为表格每个单元格设置一个背景颜色 */
        tbody td {
            background-color: #f2f2f2; /* 示例背景颜色，可根据喜好修改 */
            border-bottom: 1px solid #ddd; /* 为了清晰分隔各行 */
        }

        /* 为操作按钮增加一些样式来使其更加醒目 */
        .order-detail-toggle {
            border: none; /* 移除边框 */
            color: white; /* 设置字体颜色 */
            padding: 5px 10px; /* 设置内填充 */
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            transition-duration: 0.4s;
            cursor: pointer;
            background-color: #008CBA; /* 背景颜色 */
        }

        /* 当鼠标悬停在操作按钮上时，改变其样式以提供反馈 */
        .order-detail-toggle:hover {
            background-color: #333;
            color: white;
        }

        /* 为发货按钮增加一些样式来使其更加醒目 */
        .order-ship-toggle {
            border: none; /* 移除边框 */
            color: white; /* 设置字体颜色 */
            padding: 5px 10px; /* 设置内填充 */
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            transition-duration: 0.4s;
            cursor: pointer;
            background-color: #29ce01; /* 背景颜色 */
        }

        /* 当鼠标悬停在发货按钮上时，改变其样式以提供反馈 */
        .order-ship-toggle:hover {
            background-color: #333;
            color: white;
        }

        /* 为按钮增加一些样式来使其更加醒目 */
        .order-return-toggle {
            border: none; /* 移除边框 */
            color: white; /* 设置字体颜色 */
            padding: 5px 10px; /* 设置内填充 */
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            transition-duration: 0.4s;
            cursor: pointer;
            background-color: #e7a054; /* 背景颜色 */
        }

        /* 当鼠标悬停在发货按钮上时，改变其样式以提供反馈 */
        .order-return-toggle:hover {
            background-color: #333;
            color: white;
        }

        .Model {
            display: none; /* 默认不显示模态框 */
            position: fixed; /* 固定定位 */
            z-index: 1; /* z-index 确保模态框在其他内容上方 */
            left: 0;
            top: 0;
            width: 100%; /* 宽度为整个视窗的宽 */
            height: 100%; /* 高度为整个视窗的高 */
            overflow: auto; /* 如果内容过多，出现滚动条 */
            background-color: rgba(0, 0, 0, 0.4); /* 背景颜色带透明度 */
        }

        .Model-content {
            background-color: #fefefe; /* 模态框内容背景颜色 */
            margin: 5% auto; /* 上下外边距及自动居中 */
            padding: 20px; /* 内边距 */
            border: 1px solid #888; /* 边框 */
            width: 50%; /* 宽度 */
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2); /* 添加阴影效果 */
            position: relative; /* 相对定位 */
            overflow: hidden; /* 隐藏溢出的内容 */
            border-radius: 10px; /* 圆角边框 */
        }

        /* 模态框标题样式 */
        .Model-content h2 {
            background-color: #4CAF50; /* 标题背景颜色 */
            color: white; /* 标题文本颜色 */
            padding: 10px 20px; /* 标题内填充 */
            margin: -20px -20px 20px -20px; /* 标题外边距 */
            border-top-left-radius: 10px; /* 左上角圆角 */
            border-top-right-radius: 10px; /* 右上角圆角 */
            text-align: center; /* 文本居中 */
        }

        /* 模态框关闭按钮样式 */
        .close {
            position: absolute; /* 绝对定位 */
            top: 10px; /* 距离顶部 */
            right: 20px; /* 距离右侧 */
            color: #aaa; /* 颜色 */
            text-shadow: none; /* 禁用文本阴影 */
            font-weight: normal; /* 字重 */
        }

        /* 模态框中的段落样式 */
        .Model-content p {
            font-size: 16px; /* 字体大小 */
            line-height: 1.6; /* 行高 */
            margin-bottom: 15px; /* 段落之间的间距 */
            text-align: left; /* 文本左对齐 */
            border-bottom: 1px solid #eee; /* 可选：每个信息项之间的分割线 */
            padding-bottom: 10px; /* 可选：分割线上方的内边距 */
        }

        /* 最后一个段落的样式，没有底部边框 */
        .Model-content p:last-of-type {
            border-bottom: none; /* 去掉最后一个段落的分割线 */
            margin-bottom: 0; /* 调整最后一个段落的外边距 */
            padding-bottom: 0; /* 调整最后一个段落的内边距 */
        }

        /* 模态框中图片的样式 */
        .Model-content img {
            margin-top: 10px; /* 图片上方的外边距 */
            display: block; /* 使图片块状显示 */
            margin-left: auto; /* 左自动外边距 */
            margin-right: auto; /* 右自动外边距 */
            max-width: 100%; /* 最大宽度为容器宽度 */
            height: auto; /* 高度自动 */
        }

        .close {
            color: #0c0c0c; /* 关闭按钮颜色 */
            float: right; /* 右浮动 */
            font-size: 28px; /* 字号 */
            font-weight: bold; /* 字重 */
        }

        .close:hover,
        .close:focus {
            color: #e11111; /* 鼠标悬浮或聚焦时颜色改变 */
            text-decoration: none;
            cursor: pointer;
        }

        tbody tr.order-row:hover {
            font-size: 13px; /* 设定鼠标悬停时的字体大小 */
            cursor: pointer; /* 可选，显示鼠标悬停效果 */
            transition: font-size 0.8s ease; /* 平滑的字体大小变化 */
            color: #008CBA; /* 蓝色字体 */
        }

        /* “详情”行在悬停时的样式 */
        tbody tr.order-detail-row:hover {
            color: #008CBA;
            font-size: 13px; /* 设定鼠标悬停时的字体大小 */
            cursor: default;
            transition: background-color 0.3s ease;
        }

        /* 设置为链接的用户名字和商品名字的样式 */
        .dialogue-link {
            cursor: pointer;
            color: #008CBA; /* 蓝色字体 */
            text-decoration: underline; /* 文字下划线 */
            transition: font-size 0.5s ease; /* 平滑的字体大小变化 */
        }

        /* 鼠标悬停在用户名字和商品名字上时的样式 */
        .dialogue-link:hover {
            font-size: 20px; /* 鼠标悬停时字体大小变大 */
            color: #f51111; /* 鼠标悬停时字体颜色的变化 */
        }

        /* 设置搜索框区域的样式 */
        #search-order-bar {
            background-color: #d8e8f8; /* 设置搜索栏的背景颜色 */
            padding: 20px; /* 设置内边距使内容不紧贴边框 */
            border-radius: 8px; /* 设置边框为圆角 */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* 添加层次感的阴影效果 */
            margin-bottom: 20px; /* 与页面其他部分保持距离 */
        }

        .search-row {
            display: flex; /* 继续使用Flexbox布局 */
            justify-content: space-between; /* 使内容均匀分布在行中 */
            flex-wrap: wrap; /* 如果有必要，允许内容换行 */
            gap: 10px; /* 维持字段之间的间隔为10px */
            margin-bottom: 18px; /* 行与行之间保留20px的距离 */
        }

        /* 设置搜索字段的边框和背景 */
        .search-field {
            display: flex; /* 使用Flexbox布局 */
            flex-direction: row; /* 子元素方向排列 */
            border: 1px solid #000000; /* 设置边框颜色和宽度 */
            background-color: #9ad0ff; /* 设置背景颜色 */
            border-radius: 4px; /* 字段的边框圆角 */
            padding-left: 10px; /* 字段内部左边距 */
            margin-right: 8px; /* 字段间的距离 */
            flex: 1; /* 每个字段都可以根据内容自动伸缩 */
            max-width: calc(33.333333333% - 1px); /* 最大宽度为行宽的三分之一减去定义的间隔（这里考虑了每行最多3个搜索字段） */
            box-sizing: border-box; /* 包括padding和border在内部的总宽度计算 */
        }

        .range-input {
            flex: 1; /* 允许输入框填满父容器分配的空间 */
            max-width: calc(30% - 10px); /* 调整计算公式以避免换行，需要根据实际情况留出一定空间给分隔符 */
            background-color: #ffffff; /* 浅蓝色背景，你可以根据需要进行更改 */
            border: 1px solid #b6d4fd; /* 浅蓝色边框 */
            border-radius: 4px; /* 圆角边框 */
            padding: 5px; /* 内填充 */
            margin: 0 5px; /* 与分隔符或其他输入框的外边距留白 */
            text-align: start; /* 文本居中 */
        }

        .range-separator {
            display: inline-block;
            line-height: 30px; /* 将分隔符垂直对齐 */
        }

        /* 通过这个类为范围输入字段定制更多样式 */
        .range-field {
            display: flex;
            align-items: center; /* 垂直居中对齐 */
            flex-wrap: nowrap; /* 阻止内部元素换行 */
            justify-content: flex-start; /* 根据需要调整，这里是从行首开始排列 */
            width: 20%; /* 确保占满父容器宽度 */
        }

        .search-order-button {
            display: flex; /* 开启Flexbox布局 */
            margin-bottom: 1px; /* 与其他内容保持一定间距 */
        }

        /* 搜索订单按钮的样式 */
        .search-order-button a {
            flex-grow: 1; /* 按钮占满整行的空间 */
            text-align: center; /* 文本居中 */
            padding: 10px 0; /* 增加上下内边距 */
            background-color: #007bff; /* 设置按钮的背景颜色 */
            color: white; /* 设置按钮文本的颜色 */
            font-size: 15px; /* 设置字体大小 */
            border-radius: 5px; /* 圆角边框 */
            text-decoration: none; /* 去除文本下划线 */
            border: none; /* 去除边框 */
            transition: background-color 0.3s ease-in-out; /* 添加背景颜色变化的过渡效果 */
        }

        /* 鼠标悬停状态下按钮的样式 */
        .search-order-button a:hover {
            background-color: #0056b3; /* 按钮背景颜色加深 */
            cursor: pointer; /* 鼠标变为指针形状 */
        }

        .search-row-date {
            display: flex;
            justify-content: space-between; /* 确保元素均匀分布 */
            margin-bottom: 10px; /* 如有需要可以设置底部外边距 */
        }

        .search-row-date > .search-field {
            flex: 1; /* 每个搜索字段都尽可能大地填充可用空间 */
            display: flex;
            padding-left: 10px; /* 字段内部左边距 */
            justify-content: space-between; /* 输入框之间均匀分布空间 */
            align-items: center; /* 垂直居中对齐 */
            max-width: calc(50% - 50px); /* 最大宽度为行宽的三分之一减去定义的间隔（这里考虑了每行最多3个搜索字段） */
        }

        .search-row-date .range-input {
            flex: 1; /* 输入框增长以填满他们的容器 */
            justify-content: flex-start; /* 根据需要调整，这里是从行首开始排列 */
        }

        .search-row-date .range-separator {
            margin: 0 1px; /* 分隔符的左右外边距 */
        }

        /* 设置搜索输入字段和选择菜单的字体大小 */
        .search-field input,
        .search-field select,
        .search-field label {
            font-size: 18px; /* 或你希望的任何大小 */

        }

        /* 目标只有在 .search-buttons 下的 .search-field 的元素 */
        .search-buttons .search-field-buttons {
            background-color: #d8e8f8; /* 这里的背景色是灰色, 你可以根据需要更改 */
            padding: 10px; /* 添加一些填充, 使背景更显著 */
            border-radius: 5px; /* 如果需要，给背景添加圆角 */
            display: flex; /* 使用Flexbox布局 */
            justify-content: center; /* 将按钮放置在中心 */
        }

        /* 美化按钮的样式 */
        input[type="submit"], input[type="reset"] {
            cursor: pointer; /* 鼠标悬停时的手型光标 */
            font-weight: bold; /* 字体加粗 */
            background-color: #007bff; /* 背景颜色 */
            border: none; /* 无边框 */
            border-radius: 10px; /* 圆角边框 */
            color: white; /* 文字颜色 */
            padding: 10px 20px; /* 内边距 */
            margin: 0 5px; /* 外边距进行留白 */
            transition: background-color 0.3s; /* 过渡效果使按钮按下更具反馈 */
        }

        /* 添加鼠标悬停时按钮的效果 */
        input[type="submit"]:hover, input[type="reset"]:hover {
            background-color: #0056b3; /* 按钮被悬停时的背景颜色 */
        }

        /* 清除搜索按钮特定样式 */
        input[type="reset"] {
            background-color: #6c757d; /* 设置清除按钮的背景颜色 */
        }

        input[type="reset"]:hover {
            background-color: #5a6268; /* 按钮被悬停时的背景颜色 */
        }

        /* 没有商品时显示的动画效果 */
        .no-products-animation2 {
            display: none; /* 默认不显示，通过JavaScript控制显示 */
            animation: fadeInToRed 2s ease infinite; /* 添加淡入淡出的无限循环动画，每次动画持续3秒 */
            position: fixed; /* 使用固定定位，确保元素即使在页面滚动时也保持在预定位置 */
            bottom: 6%; /* 相对于视口底部的位置，调整这个值可以控制元素距离底部的高度 */
            left: 50%; /* 相对于视口左侧的位置，保证元素水平居中 */
            transform: translateX(-50%); /* 水平居中元素；由于是相对于左侧50%定位，需要左移元素宽度的50%来实现居中 */
            width: 100%; /* 元素宽度设置为100%，这样文本居中可以相对于整个视口宽度居中 */
        }

        /* 没有商品时显示的文本样式 */
        .no-products-animation2 p {
            text-align: center; /* 文本居中对齐 */
            font-size: 5em; /* 字体大小为2em，根据需要调整 */
            color: #f82800; /* 字体颜色为淡红色，看起来更柔和 */
            margin: 0; /* 移除默认的边距，确保元素位置准确 */
        }

        /* 键帧动画 */
        @keyframes fadeInToRed {
            from {
                opacity: 0; /* 开始时完全透明 */
                background-color: transparent; /* 背景色为透明 */
            }
            to {
                opacity: 1; /* 结束时完全不透明 */
                background-color: #ffffff; /* 背景色变为红色 */
            }
        }

        .shop_order_content {
            max-width: 1350px; /* 根据设计调整 */
            margin: 0 auto; /* 水平居中 */
            padding: 1px; /* 增加一些内边距 */
            box-sizing: border-box; /* 防止内边距影响宽度 */
        }
    </style>
</head>
<body>

<div class="shop_head">
    <div class="shop_head-in">
        <div class="shop_register"><a href="{% url 'logout' %}">退出登录</a></div>
        <div class="shop_register"><a href="http://127.0.0.1:8000/shop/shoppage/shop_profile">查看个人信息</a></div>
    </div>
</div>
<div class="shop_search">
    <form action="{% url 'myproducts' %}" method="get" id="search-form" class="input">
        <img src="{% static '首页_files/1_06.png' %}" onclick="document.getElementById('search-form').submit();"
             style="cursor: pointer;" alt="Search">
        <input type="text" name="query" id="search-box" value="{{ query|default_if_none:'请输入想找的宝贝' }}"
               style="color: {{ query|yesno:'#000,#aaa' }};"
               onfocus="if (this.value == '请输入想找的宝贝') {this.value = ''; this.style.color = '#000';}"
               onblur="if (this.value == '') {this.value = '请输入想找的宝贝'; this.style.color = '#aaa';}">
    </form>
</div>
<div class="shop_classes">
    <div class="shop_classes-top">
        <ul class="shop_classes-items">
            <li class="shop_items"><a
                    href="http://127.0.0.1:8000/shop/shoppage/?category_id=0&query={{ query|default_if_none:'请输入想找的宝贝' }}">首页</a>
            </li>
            <li class="shop_items"><a
                    href="http://127.0.0.1:8000/shop/shoppage/myproducts/?category_id=0&query=">我的商品</a></li>
            <li class="shop_items"><a
                    href="http://127.0.0.1:8000/shop/shoppage/manage_products/?category_id=0">管理商品</a>
            </li>
            <li class="shop_items"><a href="http://127.0.0.1:8000/shop/shoppage/shop_order/"
                                      class="selected1">我的订单</a>
            </li>
            <li class="shop_items"><a href="http://127.0.0.1:8000/shop/shoppage/rfm/">RFM分析</a></li>
        </ul>
    </div>
</div>
<div class="shop_order_content">
    <!-- 在这里添加一个 '搜索订单' 的按钮 -->
    <div class="search-order-button">
        <a href="javascript:void(0);" onclick="toggleSearchBar();" class="btn btn-info">搜索订单</a>
    </div>
    <!-- 创建一个初始隐藏的搜索栏 -->
    <div class="search-section">
        <div id="search-order-bar" style="display: none;">
            <form action="{% url 'shop_search_orders' %}" method="get">
                <div class="search-product">
                    <h3>搜索商品</h3>
                    <!-- 第一行 -->
                    <div class="search-row">
                        <div class="search-field">
                            <label for="product_name">商品名称:</label>
                            <input type="text" id="product_name" name="product_name" placeholder="商品名称"
                                   value="{{ product_name }}" maxlength="50">
                        </div>
                        <div class="search-field">
                            <label for="brand">商品品牌:</label>
                            <input type="text" id="brand" name="brand" placeholder="品牌" value="{{ brand }}"
                                   maxlength="50">
                        </div>
                        <div class="search-field range-field">
                            <label for="stock_range">库存范围:</label>
                            <input type="number" class="range-input" id="min_stock" name="min_stock"
                                   placeholder="最低库存" value="{{ min_stock }}" min="0" max="99999">
                            <span class="range-separator">~</span>
                            <input type="number" class="range-input" id="max_stock" name="max_stock"
                                   placeholder="最高库存" value="{{ max_stock }}" min="0" max="99999">
                        </div>
                    </div>
                    <!-- 第二行 -->
                    <div class="search-row">
                        <div class="search-field">
                            <label for="category_id">商品类别:</label>
                            <select id="category_id" name="category_id">
                                <option value="0" {% if category_id == "0" %}selected{% endif %}>全部商品</option>
                                <option value="1" {% if category_id == "1" %}selected{% endif %}>个人电脑和配件</option>
                                <option value="2" {% if category_id == "2" %}selected{% endif %}>移动设备</option>
                                <option value="3" {% if category_id == "3" %}selected{% endif %}>家用电子产品</option>
                                <option value="4" {% if category_id == "4" %}selected{% endif %}>厨房电子设备</option>
                                <option value="5" {% if category_id == "5" %}selected{% endif %}>办公设备</option>
                                <option value="6" {% if category_id == "6" %}selected{% endif %}>汽车电子设备</option>
                                <option value="7" {% if category_id == "7" %}selected{% endif %}>网络和通信设备</option>
                                <option value="8" {% if category_id == "8" %}selected{% endif %}>可穿戴设备</option>
                                <option value="9" {% if category_id == "9" %}selected{% endif %}>智能家居设备</option>
                            </select>
                        </div>
                        <div class="search-field">
                            <label for="status">商品状态:</label>
                            <select id="status" name="status">
                                <option value="">所有状态</option>
                                <option value="上架" {% if status == "上架" %}selected{% endif %}>上架</option>
                                <option value="下架" {% if status == "下架" %}selected{% endif %}>下架</option>
                            </select>
                        </div>
                        <div class="search-field">
                            <label for="audit_status">审核状态:</label>
                            <select id="audit_status" name="audit_status">
                                <option value="">所有状态</option>
                                <option value="待审核" {% if audit_status == "待审核" %}selected{% endif %}>待审核
                                </option>
                                <option value="审核通过" {% if audit_status == "审核通过" %}selected{% endif %}>审核通过
                                </option>
                                <option value="审核不通过" {% if audit_status == "审核不通过" %}selected{% endif %}>
                                    审核不通过
                                </option>
                            </select>
                        </div>
                    </div>
                    <!-- 第三行 -->
                    <div class="search-row">
                        <div class="search-field range-field">
                            <label for="original_price">原始价格:</label>
                            <input type="number" class="range-input" id="min_original_price" name="min_original_price"
                                   placeholder="最低价" value="{{ min_original_price }}" min="0" max="99999">
                            <span class="range-separator">~</span>
                            <input type="number" class="range-input" id="max_original_price" name="max_original_price"
                                   placeholder="最高价" value="{{ max_original_price }}" min="0" max="99999">
                        </div>
                        <div class="search-field range-field">
                            <label for="current_price">现在价格:</label>
                            <input type="number" class="range-input" id="min_current_price" name="min_current_price"
                                   placeholder="最低价" value="{{ min_current_price }}" min="0" max="99999">
                            <span class="range-separator">~</span>
                            <input type="number" class="range-input" id="max_current_price" name="max_current_price"
                                   placeholder="最高价" value="{{ max_current_price }}" min="0" max="99999">
                        </div>
                        <div class="search-field range-field">
                            <label for="discount">商品折扣:</label>
                            <input type="number" class="range-input" id="min_discount" name="min_discount"
                                   placeholder="最小折扣" value="{{ min_discount }}" step="0.01" min="0" max="1">
                            <span class="range-separator">~</span>
                            <input type="number" class="range-input" id="max_discount" name="max_discount"
                                   placeholder="最大折扣" value="{{ max_discount }}" step="0.01" min="0" max="1">
                        </div>
                    </div>
                    <!-- 第四行 -->
                    <div class="search-row">
                        <div class="search-field">
                            <label for="description">商品描述:</label>
                            <input type="text" id="description" name="description" placeholder="描述"
                                   value="{{ description }}"
                                   maxlength="50">
                        </div>
                    </div>
                </div>
                <!-- 搜索订单的部分 -->
                <div class="search-order">
                    <h3>搜索订单</h3>
                    <div class="search-row">
                        <div class="search-field">
                            <label for="order_status">订单状态:</label>
                            <select id="order_status" name="order_status">
                                <option value="">所有状态</option>
                                <option value="待付款" {% if order_status == "待付款" %}selected{% endif %}>待付款
                                </option>
                                <option value="待发货" {% if order_status == "待发货" %}selected{% endif %}>待发货
                                </option>
                                <option value="待收货" {% if order_status == "待收货" %}selected{% endif %}>待收货
                                </option>
                                <option value="已收货" {% if order_status == "已收货" %}selected{% endif %}>已收货
                                </option>
                                <option value="待退货" {% if order_status == "待退货" %}selected{% endif %}>待退货
                                </option>
                                <option value="已退货" {% if order_status == "已退货" %}selected{% endif %}>已退货
                                </option>
                                <option value="已完成" {% if order_status == "已完成" %}selected{% endif %}>已完成
                                </option>
                            </select>
                        </div>
                        <div class="search-field range-field">
                            <label for="order_total_price">订单总价:</label>
                            <input type="number" class="range-input" id="min_order_total_price"
                                   name="min_order_total_price"
                                   placeholder="最低总价" value="{{ min_order_total_price }}" min="0" max="9999999">
                            <span class="range-separator">~</span>
                            <input type="number" class="range-input" id="max_order_total_price"
                                   name="max_order_total_price"
                                   placeholder="最高总价" value="{{ max_order_total_price }}" min="0" max="9999999">
                        </div>
                        <!-- 按订单地址搜索 -->
                        <div class="search-field">
                            <label for="order_address">订单地址:</label>
                            <input type="text" id="order_address" name="order_address" placeholder="订单地址"
                                   value="{{ order_address }}" maxlength="70">
                        </div>
                    </div>
                    <div class="search-row-date">
                        <!-- 按订单支付时间搜索 -->
                        <div class="search-field range-field date-range-field">
                            <label for="paid_time_range">支付时间:</label>
                            <input type="date" class="range-input" id="min_paid_time" name="min_paid_time"
                                   placeholder="起始日期" value="{{ min_paid_time }}">
                            <span class="range-separator">至</span>
                            <input type="date" class="range-input" id="max_paid_time" name="max_paid_time"
                                   placeholder="结束日期" value="{{ max_paid_time }}">
                        </div>
                        <!-- 按订单创建时间搜索 -->
                        <div class="search-field range-field date-range-field">
                            <label for="created_time_range">订单时间:</label>
                            <input type="date" class="range-input" id="min_created_time" name="min_created_time"
                                   placeholder="起始日期" value="{{ min_created_time }}">
                            <span class="range-separator">至</span>
                            <input type="date" class="range-input" id="max_created_time" name="max_created_time"
                                   placeholder="结束日期" value="{{ max_created_time }}">
                        </div>
                    </div>
                </div>

                <!-- 搜索用户的部分 -->
                <div class="search-user">
                    <h3>搜索用户</h3>
                    <div class="search-row">
                        <div class="search-field">
                            <label for="user_name">用户名字:</label>
                            <input type="text" id="user_name" name="user_name" placeholder="用户名字"
                                   value="{{ user_name }}" maxlength="10">
                        </div>
                        <div class="search-field">
                            <label for="user_phone">电话号码:</label>
                            <input type="tel" id="user_phone" name="user_phone" placeholder="电话号码"
                                   value="{{ user_phone }}" maxlength="11" pattern="[0-9]{11}">
                        </div>
                        <div class="search-field">
                            <label for="user_sex">用户性别:</label>
                            <select id="user_sex" name="user_sex">
                                <option value="">所有</option>
                                <option value="男" {% if user_sex == "男" %}selected{% endif %}>男</option>
                                <option value="女" {% if user_sex == "女" %}selected{% endif %}>女</option>
                            </select>
                        </div>
                    </div>
                    <div class="search-row">
                        <div class="search-field">
                            <label for="user_email">用户邮箱:</label>
                            <input type="email" id="user_email" name="user_email" placeholder="电子邮件地址"
                                   value="{{ user_email }}" maxlength="20">
                        </div>
                    </div>
                </div>
                <!-- 按钮行 -->
                <div class="search-buttons"> <!-- 添加 search-buttons 类 -->
                    <div class="search-field-buttons">
                        <input type="submit" value="搜索" class="search-button"> <!-- 添加 search-button 类 -->
                        <input type="reset" value="清除搜索" class="search-button clear-search-button"
                               onclick="clearSearch()"> <!-- 添加 clear-search-button 类 -->
                    </div>
                </div>
            </form>
        </div>
    </div>
    {% if orders %}
        <table>
            <thead>
            <tr>
                <th>订单ID</th>
                <th>用户</th>
                <th>状态</th>
                <th>支付时间</th>
                <th>订单时间</th>
                <th>总价</th>
                <th>收货地址</th>
                <th>操作</th> <!-- 添加一个标题用于展示操作按钮 -->
            </tr>
            </thead>
            <tbody>
            {% for order in orders %}
                <tr class="order-row" data-order-id="{{ order.o_id }}">
                    <td>{{ order.o_id }}</td>
                    <td>
            <span class="dialogue-link" onclick="showUserModel({{ order.user.u_id }}); event.stopPropagation();">
                {{ order.user.u_name }}
            </span>
                    </td>
                    <td id="status-{{ order.o_id }}">{{ order.status }}</td>
                    <td>{{ order.paid_time }}</td>
                    <td>{{ order.o_time }}</td>
                    <td>{{ order.total_price }}</td>
                    <td>{{ order.order_address }}</td>
                    <td>
                        <button class="order-detail-toggle"
                                onclick="toggleOrderDetails('details-{{ order.o_id }}'); event.stopPropagation();">
                            详情
                        </button>
                        <!-- 根据订单状态显示发货按钮 -->
                        {% if order.status == '待发货' %}
                            <button class="order-ship-toggle"
                                    onclick="showShipModal({{ order.o_id }}); event.stopPropagation();">
                                发货
                            </button>
                        {% endif %}
                        <!-- 根据订单状态显示退货按钮 -->
                        {% if order.status == '待退货' %}
                            <button class="order-return-toggle"
                                    onclick="showReturnModal({{ order.o_id }});event.stopPropagation();">
                                已退货
                            </button>
                        {% endif %}
                    </td>
                </tr>
                <tr id="details-{{ order.o_id }}" class="order-details">
                    <td colspan="7">
                        <table>
                            <thead>
                            <tr>
                                <th>订单详情ID</th>
                                <th>商品图片</th>
                                <th>商品</th>
                                <th>商店</th>
                                <th>数量</th>
                                <th>购买时单价</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for detail in order.orderdetails_set.all %}
                                <tr class="order-detail-row" data-order-id="{{ order.o_id }}">
                                    <td>{{ detail.order_detail_id }}</td>
                                    <td>
                                        <img src="{% static '商品图片/'|add:detail.product.product_image_url %}"
                                             alt="{{ detail.product.product.p_name }}" width="80px" height="80px">
                                    </td> <!-- 新增的列，显示商品图片 -->
                                    <td>
                                <span class="dialogue-link"
                                      onclick="showProductModel({{ detail.product.product.p_id }})">
                                           {{ detail.product.product.p_name }}
                                </span>
                                    </td>
                                    <td>{{ detail.shop.s_name }}</td>
                                    <td>{{ detail.quantity }}</td>
                                    <td>{{ detail.current_single_price }}</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% else %}
        <div class="no-products-animation2">
            <p>没有找到任何订单</p>
        </div>
    {% endif %}
</div>
{% if orders %}
    <!-- 分页 -->
    <div class="pagination">
    <span class="step-links">
        {% if orders.has_previous %}
            <a href="?page=1&category_id={{ category_id }}&product_name={{ product_name }}&brand={{ brand }}&description={{ description }}&status={{ status }}&audit_status={{ audit_status }}&min_stock={{ min_stock }}&max_stock={{ max_stock }}&min_original_price={{ min_original_price }}&max_original_price={{ max_original_price }}&min_discount={{ min_discount }}&max_discount={{ max_discount }}&min_current_price={{ min_current_price }}&max_current_price={{ max_current_price }}&order_status={{ order_status }}&min_order_total_price={{ min_order_total_price }}&max_order_total_price={{ max_order_total_price }}&order_address={{ order_address }}&min_paid_time={{ min_paid_time }}&max_paid_time={{ max_paid_time }}&min_created_time={{ min_created_time }}&max_created_time={{ max_created_time }}&user_name={{ user_name }}&user_phone={{ user_phone }}&user_sex={{ user_sex }}&user_email={{ user_email }}">&laquo; 第一页</a>
            <a href="?page={{ orders.previous_page_number }}&category_id={{ category_id }}&product_name={{ product_name }}&brand={{ brand }}&description={{ description }}&status={{ status }}&audit_status={{ audit_status }}&min_stock={{ min_stock }}&max_stock={{ max_stock }}&min_original_price={{ min_original_price }}&max_original_price={{ max_original_price }}&min_discount={{ min_discount }}&max_discount={{ max_discount }}&min_current_price={{ min_current_price }}&max_current_price={{ max_current_price }}&order_status={{ order_status }}&min_order_total_price={{ min_order_total_price }}&max_order_total_price={{ max_order_total_price }}&order_address={{ order_address }}&min_paid_time={{ min_paid_time }}&max_paid_time={{ max_paid_time }}&min_created_time={{ min_created_time }}&max_created_time={{ max_created_time }}&user_name={{ user_name }}&user_phone={{ user_phone }}&user_sex={{ user_sex }}&user_email={{ user_email }}">上一页</a>
        {% endif %}
        <span class="current">
            第 {{ orders.number }} / {{ orders.paginator.num_pages }} 页
        </span>
        {% if orders.has_next %}
            <a href="?page={{ orders.next_page_number }}&category_id={{ category_id }}&product_name={{ product_name }}&brand={{ brand }}&description={{ description }}&status={{ status }}&audit_status={{ audit_status }}&min_stock={{ min_stock }}&max_stock={{ max_stock }}&min_original_price={{ min_original_price }}&max_original_price={{ max_original_price }}&min_discount={{ min_discount }}&max_discount={{ max_discount }}&min_current_price={{ min_current_price }}&max_current_price={{ max_current_price }}&order_status={{ order_status }}&min_order_total_price={{ min_order_total_price }}&max_order_total_price={{ max_order_total_price }}&order_address={{ order_address }}&min_paid_time={{ min_paid_time }}&max_paid_time={{ max_paid_time }}&min_created_time={{ min_created_time }}&max_created_time={{ max_created_time }}&user_name={{ user_name }}&user_phone={{ user_phone }}&user_sex={{ user_sex }}&user_email={{ user_email }}">下一页</a>
            <a href="?page={{ orders.paginator.num_pages }}&category_id={{ category_id }}&product_name={{ product_name }}&brand={{ brand }}&description={{ description }}&status={{ status }}&audit_status={{ audit_status }}&min_stock={{ min_stock }}&max_stock={{ max_stock }}&min_original_price={{ min_original_price }}&max_original_price={{ max_original_price }}&min_discount{{ min_discount }}&max_discount={{ max_discount }}&min_current_price={{ min_current_price }}&max_current_price={{ max_current_price }}&order_status={{ order_status }}&min_order_total_price={{ min_order_total_price }}&max_order_total_price{{ max_order_total_price }}&order_address={{ order_address }}&min_paid_time{{ min_paid_time }}&max_paid_time={{ max_paid_time }}&min_created_time{{ min_created_time }}&max_created_time={{ max_created_time }}&user_name={{ user_name }}&user_phone{{ user_phone }}&user_sex={{ user_sex }}&user_email={{ user_email }}">最后一页 &raquo;</a>
        {% endif %}
    </span>
        <!-- 跳转页码表单，同样传递所有搜索参数 -->
        <form action="" method="get" style="display: inline-block;">
            <!-- 保持之前的页码和搜索参数 -->
            <input type="hidden" name="category_id" value="{{ category_id }}">
            <input type="hidden" name="product_name" value="{{ product_name }}">
            <input type="hidden" name="brand" value="{{ brand }}">
            <input type="hidden" name="description" value="{{ description }}">
            <input type="hidden" name="status" value="{{ status }}">
            <input type="hidden" name="audit_status" value="{{ audit_status }}">
            <input type="hidden" name="min_stock" value="{{ min_stock }}">
            <input type="hidden" name="max_stock" value="{{ max_stock }}">
            <input type="hidden" name="min_original_price" value="{{ min_original_price }}">
            <input type="hidden" name="max_original_price" value="{{ max_original_price }}">
            <input type="hidden" name="min_discount" value="{{ min_discount }}">
            <input type="hidden" name="max_discount" value="{{ max_discount }}">
            <input type="hidden" name="min_current_price" value="{{ min_current_price }}">
            <input type="hidden" name="max_current_price" value="{{ max_current_price }}">
            <input type="hidden" name="order_status" value="{{ order_status }}">
            <input type="hidden" name="min_order_total_price" value="{{ min_order_total_price }}">
            <input type="hidden" name="max_order_total_price" value="{{ max_order_total_price }}">
            <input type="hidden" name="order_address" value="{{ order_address }}">
            <input type="hidden" name="min_paid_time" value="{{ min_paid_time }}">
            <input type="hidden" name="max_paid_time" value="{{ max_paid_time }}">
            <input type="hidden" name="min_created_time" value="{{ min_created_time }}">
            <input type="hidden" name="max_created_time" value="{{ max_created_time }}">
            <input type="hidden" name="user_name" value="{{ user_name }}">
            <input type="hidden" name="user_phone" value="{{ user_phone }}">
            <input type="hidden" name="user_email" value="{{ user_email }}">
            <input type="hidden" name="user_gender" value="{{ user_sex }}">
            <input type="number" name="page" min="1" max="{{ orders.paginator.num_pages }}" required
                   placeholder="页码" style="margin-left: 10px;">
            <input type="submit" value="跳转">
        </form>
    </div>
{% else %}
{% endif %}
<!-- 用户信息模态框 -->
<div id="userModel" class="Model">
    <div class="Model-content">
        <span class="close" onclick="closeModel('userModel')">&times;</span>
        <h2>用户信息</h2>
        <!-- 用户信息显示位置 -->
        <div id="userModelInfo">
            <p>用户名: <span id="userModel_u_name"></span></p>
            <p>性别: <span id="userModel_u_sex"></span></p>
            <p>手机号: <span id="userModel_u_phone"></span></p>
            <p>邮箱: <span id="userModel_u_email"></span></p>
        </div>
    </div>
</div>

<!-- 商品信息模态框 -->
<div id="productModel" class="Model">
    <div class="Model-content">
        <span class="close" onclick="closeModel('productModel')">&times;</span>
        <h2>商品信息</h2>
        <!-- 商品信息显示位置 -->
        <div id="productInfo">
            <p>商品名称: <span id="productModel_p_name"></span></p>
            <p>商品类型: <span id="productModel_p_type"></span></p>
            <p>品牌: <span id="productModel_brand"></span></p>
            <p>商品描述: <span id="productModel_product_desc"></span></p>
            <p>商品状态: <span id="productModel_product_status"></span></p>
            <p>库存数量: <span id="productModel_stock_quantity"></span></p>
            <p>原始价格: <span id="productModel_original_price"></span></p>
            <p>商品折扣: <span id="productModel_discount"></span></p>
            <p>当前价格: <span id="productModel_current_price"></span></p>
            <p>商品图片:</p>
            <img id="productModel_product_image" src="" alt="" width="200" height="200">
        </div>
    </div>
</div>
<!-- 模态框 - 收到脱货商品确认 -->
<div id="returnConfirmModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close-return-modal">&times;</span>
        <h2>退货确认</h2>
        <p>你确定已经收到退货了吗？</p>
        <div class="modal-actions">
            <button id="confirm_return">确定</button>
            <button class="cancel-return-modal">取消</button>
        </div>
    </div>
</div>
<!-- 发货确认模态框 -->
<div id="shipConfirmModal" class="modal" style="display: none;">
    <div class="modal-content">
        <span class="close-ship-modal">&times;</span>
        <h2>发货确认</h2>
        <p>您确定要将这个订单标记为已发货吗？</p>
        <div class="modal-actions">
            <button id="confirm_ship">确定发货</button>
            <button class="cancel-ship-modal">取消</button>
        </div>
    </div>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        document.querySelector('.no-products-animation2').style.display = 'block';
    });

    //订单详情
    function toggleOrderDetails(detailId) {
        var details = document.getElementById(detailId);
        if (details.style.display === 'none' || details.style.display === '') {
            details.style.display = 'table-row'; // 显示订单详情
        } else {
            details.style.display = 'none'; // 隐藏订单详情
        }
    }

    //-------------------------------------------模态框-------------------------------------------
    // 获取退货确认模态框元素
    var returnConfirmModal = document.getElementById('returnConfirmModal');
    var closeButtonReturnModal = returnConfirmModal.querySelector(".close-return-modal");
    var cancelReturnModalButton = returnConfirmModal.querySelector(".cancel-return-modal");
    var confirmReturnButton = returnConfirmModal.querySelector("#confirm_return");
    // 获取发货确认模态框元素
    var shipConfirmModal = document.getElementById('shipConfirmModal');
    var closeShipModalButton = shipConfirmModal.querySelector(".close-ship-modal");
    var cancelShipModalButton = shipConfirmModal.querySelector(".cancel-ship-modal");
    var confirmShipButton = shipConfirmModal.querySelector("#confirm_ship");

    // 打开发货确认模态框的函数
    function showShipModal(orderId) {
        confirmShipButton.onclick = function () {
            // 这里应该实现确认发货的逻辑，需要您自己实现相关功能
            shipOrder(orderId);
        };
        shipConfirmModal.style.display = "block";
    }

    // 点击退货按钮时，显示退货确认模态框，并绑定需要退货商品的ID
    function showReturnModal(orderId) {
        confirmReturnButton.onclick = function () {
            confirmReturnOrder(orderId); // 执行退货操作的函数，需要你自己来实现
        };
        returnConfirmModal.style.display = "block";
    }

    // 点击关闭按钮关闭发货确认模态框
    closeShipModalButton.onclick = function () {
        shipConfirmModal.style.display = "none";
    };
    // 点击取消按钮关闭发货确认模态框
    cancelShipModalButton.onclick = function () {
        shipConfirmModal.style.display = "none";
    };
    // 点击关闭按钮关闭退货确认模态框
    closeButtonReturnModal.onclick = function () {
        returnConfirmModal.style.display = "none";
    }
    // 点击取消按钮关闭退货确认模态框
    cancelReturnModalButton.onclick = function () {
        returnConfirmModal.style.display = "none";
    }
    // 点击窗口外区域关闭退货确认模态框
    window.onclick = function (event) {
        if (event.target == returnConfirmModal) {
            returnConfirmModal.style.display = "none";
        } else if (event.target == shipConfirmModal) {
            shipConfirmModal.style.display = "none";
        } else if (event.target.className === 'Model') {
            event.target.style.display = 'none';
        }
    }

    // 关闭模态框的函数
    function closeModel(ModelId) {
        // 隐藏模态框
        document.getElementById(ModelId).style.display = 'none';
    }

    // 在用户点击用户名时调用的函数
    function showUserModel(userId) {
        // 获取用户名字的元素并添加高亮类
        var userNameElem = document.querySelector('td[onclick="showUserModel(' + userId + ')"]');
        if (userNameElem) {
            userNameElem.classList.add('highlight');
        }
        // 发起 AJAX 请求以获取用户信息
        fetch('/shop/shoppage/shop_order/user/' + userId + '/') // 请注意路径的改变
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok ' + response.statusText);
                }
                return response.json();
            })
            .then(user => {
                // 以下代码是将获取到的用户数据填充到模态框
                document.getElementById('userModel_u_name').textContent = user.u_name;
                document.getElementById('userModel_u_sex').textContent = user.u_sex;
                document.getElementById('userModel_u_phone').textContent = user.u_phone;
                document.getElementById('userModel_u_email').textContent = user.u_email;
                // 显示模态框
                document.getElementById('userModel').style.display = 'block';
            })
            .catch(error => {
                console.error('Error fetching user data:', error);
            });
    }

    function showProductModel(p_id) {
        // 获取商品名字的元素并添加高亮类
        var productNameElem = document.querySelector('td[onclick="showProductModel(' + p_id + ')"]');
        if (productNameElem) {
            productNameElem.classList.add('highlight');
        }
        // 发起 AJAX 请求以获取商品信息
        fetch('/shop/shoppage/shop_order/product/' + p_id + '/')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok ' + response.statusText);
                }
                return response.json();
            })
            .then(product => {
                // 以下代码是将获取到的商品数据填充到模态框
                document.getElementById('productModel_p_name').textContent = product.p_name;
                document.getElementById('productModel_p_type').textContent = product.p_type;
                document.getElementById('productModel_brand').textContent = product.brand;
                // 如果您想显示其他信息，那么以下是示例
                // 确保这些元素在商品信息模态框中有对应的 span 标签
                document.getElementById('productModel_current_price').textContent = product.current_price;
                document.getElementById('productModel_product_desc').textContent = product.product_desc;
                document.getElementById('productModel_product_status').textContent = product.product_status;
                document.getElementById('productModel_stock_quantity').textContent = product.stock_quantity;
                document.getElementById('productModel_original_price').textContent = product.original_price;
                document.getElementById('productModel_discount').textContent = product.discount;
                // 设置商品图片
                var productImage = document.getElementById('productModel_product_image');
                var imageUrl = product.product_image_url ? '{% static "商品图片/" %}' + product.product_image_url : '{% static "商品图片/暂无图片.png" %}';
                productImage.src = imageUrl;
                productImage.alt = product.p_name || '商品图片'; // 使用商品名称作为图片的alt文本，如果没有名称则使用'商品图片'

                // 显示模态框
                document.getElementById('productModel').style.display = 'block';
            })

    }

    function shipOrder(orderId) {
        // 发起POST请求到服务器，以执行发货操作
        fetch('/shop/shoppage/shop_order/ship/' + orderId + '/', {
            method: 'POST', // 指定请求方法为POST
            headers: {
                'X-CSRFToken': getCookie('csrftoken'), // 从cookie中获取CSRF token
                'Content-Type': 'application/json' // 设置内容类型为JSON
            },
            body: JSON.stringify({'order_id': orderId}), // 将订单ID作为JSON格式的字符串发送
            credentials: 'same-origin'  // 确保发送请求的时候包含cookies
        })
            .then(response => {
                // 确认响应成功返回
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json(); // 解析服务器响应的JSON数据
            })
            .then(data => {
                // 这里可以根据返回的数据进行操作，比如更新页面上的订单状态
                if (data.success) {
                    document.getElementById('status-' + orderId).textContent = '待收货';
                    // 隐藏发货按钮，因为已经发货
                    // 定义一个定时器，3秒后刷新页面
                    setTimeout(function () {
                        location.reload(); // 刷新页面
                    }, 1000);
                } else {
                    // 处理服务器返回的错误，比如弹出提醒
                    alert(data.error);
                }
            })
            .catch(error => {
                // 请求出错时的处理
                console.error('There was a problem with the fetch operation:', error);
            });
    }

    function confirmReturnOrder(orderId) {
        // 发起POST请求到服务器，以执行发货操作
        fetch('/shop/shoppage/shop_order/return/' + orderId + '/', {
            method: 'POST', // 指定请求方法为POST
            headers: {
                'X-CSRFToken': getCookie('csrftoken'), // 从cookie中获取CSRF token
                'Content-Type': 'application/json' // 设置内容类型为JSON
            },
            body: JSON.stringify({'order_id': orderId}), // 将订单ID作为JSON格式的字符串发送
            credentials: 'same-origin'  // 确保发送请求的时候包含cookies
        })
            .then(response => {
                // 确认响应成功返回
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json(); // 解析服务器响应的JSON数据
            })
            .then(data => {
                // 这里可以根据返回的数据进行操作，比如更新页面上的订单状态
                if (data.success) {
                    document.getElementById('status-' + orderId).textContent = '已退货';
                    // 定义一个定时器，3秒后刷新页面
                    setTimeout(function () {
                        location.reload(); // 刷新页面
                    }, 1000);
                } else {
                    // 处理服务器返回的错误，比如弹出提醒
                    alert(data.error);
                }
            })
            .catch(error => {
                // 请求出错时的处理
                console.error('There was a problem with the fetch operation:', error);
            });

    }

    // 辅助函数用于获取cookie值
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                const cookie = cookies[i].trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }

    // 函数：当点击表格行时切换订单详情的显示
    function onRowClick(orderId) {
        toggleOrderDetails('details-' + orderId);
    }

    // 当文档加载完毕后，绑定事件到所有的订单行
    document.addEventListener('DOMContentLoaded', function () {
        var orderRows = document.querySelectorAll('.order-row');
        orderRows.forEach(function (row) {
            row.addEventListener('click', function () {
                var orderId = this.getAttribute('data-order-id');
                onRowClick(orderId);
            });
        });
    });

    // 函数：切换搜索栏的显示与隐藏
    function toggleSearchBar() {
        var searchBar = document.getElementById('search-order-bar');
        searchBar.style.display = searchBar.style.display === 'none' ? 'block' : 'none';
    }

    window.addEventListener('load', function () {
        // 初始根据URL参数判断是否应该显示搜索栏
        var searchParams = new URLSearchParams(window.location.search);

        if (searchParams.get('category_id') !== "0" || // 商品类别不是 "全部商品"
            searchParams.get('status') !== "" || // 商品状态不是 "所有状态"
            searchParams.get('audit_status') !== "" || // 审核状态不是 "所有状态"
            searchParams.get('product_name') || // 商品名称有值
            searchParams.get('brand') || // 品牌有值
            searchParams.get('description') || // 产品描述有值
            searchParams.get('min_stock') || // 最小库存有值
            searchParams.get('max_stock') || // 最大库存有值
            searchParams.get('min_original_price') || // 最低原始价格有值
            searchParams.get('max_original_price') || // 最高原始价格有值
            searchParams.get('min_current_price') || // 最低现价有值
            searchParams.get('max_current_price') || // 最高现价有值
            searchParams.get('min_discount') || // 最小折扣有值
            searchParams.get('max_discount') || // 最大折扣有值
            searchParams.get('order_status') !== "" || // 订单状态有值
            searchParams.get('min_order_total_price') || // 最小订单总价有值
            searchParams.get('max_order_total_price') || // 最大订单总价有值
            searchParams.get('order_address') || // 订单地址有值
            searchParams.get('min_paid_time') !== "" || // 最早支付时间有值
            searchParams.get('max_paid_time') !== "" || // 最晚支付时间有值
            searchParams.get('min_created_time') !== "" || // 最早创建时间有值
            searchParams.get('max_created_time') !== "" || // 最晚创建时间有值
            searchParams.get('user_name') || // 用户名有值
            searchParams.get('user_phone') || // 用户电话有值
            searchParams.get('user_sex') !== "" || // 用户邮箱有值
            searchParams.get('user_email'))// 用户性别有值
        {
            // 如果以上任一条件满足，则显示搜索栏
            document.getElementById('search-order-bar').style.display = "block";
        } else {
            // 如果没有任何搜索参数，则隐藏搜索栏
            document.getElementById('search-order-bar').style.display = "none";
        }
    });

    //判断输入框
    function validateRangeFields() {
        var minPrice = document.getElementById('min_original_price').value;
        var maxPrice = document.getElementById('max_original_price').value;
        var minDiscount = document.getElementById('min_discount').value;
        var maxDiscount = document.getElementById('max_discount').value;
        var minCurrentPrice = document.getElementById('min_current_price').value;
        var maxCurrentPrice = document.getElementById('max_current_price').value;
        var minStock = document.getElementById('min_stock');
        var maxStock = document.getElementById('max_stock');
        var minOrderTotalPrice = document.getElementById('min_order_total_price').value;
        var maxOrderTotalPrice = document.getElementById('max_order_total_price').value;
        var minPaidTime = document.getElementById('min_paid_time').value;
        var maxPaidTime = document.getElementById('max_paid_time').value;
        var minCreatedTime = document.getElementById('min_created_time').value;
        var maxCreatedTime = document.getElementById('max_created_time').value;

        if (minStock && maxStock && Number(minStock) > Number(maxStock)) {
            alert('最小库存不能大于最大库存');
            return false;
        }
        if (minPrice !== '' && maxPrice !== '' && parseFloat(minPrice) > parseFloat(maxPrice)) {
            alert('最低价格不能大于最高价格');
            return false;
        }
        if (minDiscount !== '' && maxDiscount !== '' && parseFloat(minDiscount) > parseFloat(maxDiscount)) {
            alert('最小折扣不能大于最大折扣');
            return false;
        }
        if (minCurrentPrice !== '' && maxCurrentPrice !== '' && parseFloat(minCurrentPrice) > parseFloat(maxCurrentPrice)) {
            alert('最低现价不能大于最高现价');
            return false;
        }
        if (minOrderTotalPrice !== '' && maxOrderTotalPrice !== '' && parseFloat(minOrderTotalPrice) > parseFloat(maxOrderTotalPrice)) {
            alert('最低订单总价不能大于最高订单总价');
            return false;
        }
        if (minPaidTime !== '' && maxPaidTime !== '' && minPaidTime > maxPaidTime) {
            alert('最早支付时间不能晚于最晚支付时间');
            return false;
        }
        if (minCreatedTime !== '' && maxCreatedTime !== '' && minCreatedTime > maxCreatedTime) {
            alert('最早订单时间不能晚于最晚订单时间');
            return false;
        }
        // 一切正常，允许表单提交
        return true;
    }

    document.getElementById('search-order-bar').onsubmit = function (event) {
        if (!validateRangeFields()) { // 确保这里调用的是 validateRangeFields
            event.preventDefault(); // 阻止表单提交
        }
    };

    function clearSearch() {
        // 获取搜索栏表单内的所有输入元素
        var inputs = document.getElementById('search-order-bar').querySelectorAll('input[type=text], input[type=number], select, input[type=date], input[type=tel], input[type=email]');

        // 遍历每个输入元素，将其值重置为默认值
        inputs.forEach(function (input) {
            if (input.name === "category_id") {
                // 如果是商品类别的下拉选择菜单，设置其值为"0"，表示“全部商品”
                input.value = "0";
            } else if (input.type === 'date') {
                // 如果是日期类型的输入框，设置为空字符串，即不选择日期
                input.value = '';
            } else {
                // 其他类型的输入框，设置其值为默认值
                input.value = input.dataset.defaultValue || ''; // 假设有data-default-value属性定义了每个字段的默认值
            }
        });

        // 使用 JavaScript 提交表单，重置搜索结果
        var searchForm = document.getElementById('search-order-bar').querySelector('form');
        searchForm.submit();
    }
</script>

</body>

</html>